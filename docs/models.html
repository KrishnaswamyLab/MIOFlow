---

title: Models


keywords: fastai
sidebar: home_sidebar

summary: "API details."
description: "API details."
nb_path: "03_models.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 03_models.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>&lt;frozen importlib._bootstrap&gt;:228: RuntimeWarning: scipy._lib.messagestream.MessageStream size changed, may indicate binary incompatibility. Expected 56 from C header, got 64 from PyObject
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ToyODE" class="doc_header"><code>class</code> <code>ToyODE</code><a href="https://github.com/KrishnaswamyLab/MIOFlow/tree/main/MIOFlow/models.py#L10" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ToyODE</code>(<strong><code>feature_dims</code></strong>=<em><code>5</code></em>, <strong><code>layers</code></strong>=<em><code>[64]</code></em>, <strong><code>activation</code></strong>=<em><code>'ReLU'</code></em>, <strong><code>scales</code></strong>=<em><code>None</code></em>, <strong><code>n_aug</code></strong>=<em><code>2</code></em>) :: <code>Module</code></p>
</blockquote>
<p>ODE derivative network</p>
<p>feature_dims (int) default '5': dimension of the inputs, either in ambient space or embedded space.
layer (list of int) defaulf ''[64]'': the hidden layers of the network.
activation (torch.nn) default '"ReLU"': activation function applied in between layers.
scales (NoneType|list of float) default 'None': the initial scale for the noise in the trajectories. One scale per bin, add more if using an adaptative ODE solver.
n_aug (int) default '1': number of added dimensions to the input of the network. Total dimensions are features_dim + 1 (time) + n_aug.</p>
<p>Method
forward (Callable)
    forward pass of the ODE derivative network.
    Parameters:
    t (torch.tensor): time of the evaluation.
    x (torch.tensor): position of the evalutation.
    Return:
    derivative at time t and position x.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="make_model" class="doc_header"><code>make_model</code><a href="https://github.com/KrishnaswamyLab/MIOFlow/tree/main/MIOFlow/models.py#L64" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>make_model</code>(<strong><code>feature_dims</code></strong>=<em><code>5</code></em>, <strong><code>layers</code></strong>=<em><code>[64]</code></em>, <strong><code>output_dims</code></strong>=<em><code>5</code></em>, <strong><code>activation</code></strong>=<em><code>'ReLU'</code></em>, <strong><code>which</code></strong>=<em><code>'ode'</code></em>, <strong><code>method</code></strong>=<em><code>'rk4'</code></em>, <strong><code>rtol</code></strong>=<em><code>None</code></em>, <strong><code>atol</code></strong>=<em><code>None</code></em>, <strong><code>scales</code></strong>=<em><code>None</code></em>, <strong><code>n_aug</code></strong>=<em><code>2</code></em>, <strong><code>noise_type</code></strong>=<em><code>'diagonal'</code></em>, <strong><code>sde_type</code></strong>=<em><code>'ito'</code></em>, <strong><code>use_norm</code></strong>=<em><code>False</code></em>, <strong><code>use_cuda</code></strong>=<em><code>False</code></em>, <strong><code>in_features</code></strong>=<em><code>2</code></em>, <strong><code>out_features</code></strong>=<em><code>2</code></em>, <strong><code>gunc</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Creates the 'ode' model or 'sde' model or the Geodesic Autoencoder.
See the parameters of the respective classes.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Autoencoder" class="doc_header"><code>class</code> <code>Autoencoder</code><a href="https://github.com/KrishnaswamyLab/MIOFlow/tree/main/MIOFlow/models.py#L105" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Autoencoder</code>(<strong><code>encoder_layers</code></strong>=<em><code>[100, 100, 20]</code></em>, <strong><code>decoder_layers</code></strong>=<em><code>[20, 100, 100]</code></em>, <strong><code>activation</code></strong>=<em><code>'Tanh'</code></em>, <strong><code>use_cuda</code></strong>=<em><code>False</code></em>) :: <code>Module</code></p>
</blockquote>
<p>Geodesic Autoencoder</p>
<p>encoder_layers (list of int) default '[100, 100, 20]': encoder_layers[0] is the feature dimension, and encoder_layers[-1] the embedded dimension.
decoder_layers (list of int) defaulf '[20, 100, 100]': decoder_layers[0] is the embbeded dim and decoder_layers[-1] the feature dim.
activation (torch.nn) default '"Tanh"': activation function applied in between layers.
use_cuda (bool) default to False: Whether to use GPU or CPU.</p>
<p>Method
encode
    forward pass of the encoder
    x (torch.tensor): observations
    Return:
    the encoded observations
decode
    forward pass of the decoder
    z (torch.tensor): embedded observations
    Return:
    the decoded observations
forward (Callable):
    full forward pass, encoder and decoder
    x (torch.tensor): observations
    Return:
    denoised observations</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ToyModel" class="doc_header"><code>class</code> <code>ToyModel</code><a href="https://github.com/KrishnaswamyLab/MIOFlow/tree/main/MIOFlow/models.py#L177" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ToyModel</code>(<strong><code>func</code></strong>, <strong><code>method</code></strong>=<em><code>'rk4'</code></em>, <strong><code>rtol</code></strong>=<em><code>None</code></em>, <strong><code>atol</code></strong>=<em><code>None</code></em>, <strong><code>use_norm</code></strong>=<em><code>False</code></em>) :: <code>Module</code></p>
</blockquote>
<p>Neural ODE
    func (nn.Module): The network modeling the derivative.
    method (str) defaulf '"rk4"': any methods from torchdiffeq.
    rtol (NoneType | float): the relative tolerance of the ODE solver.
    atol (NoneType | float): the absolute tolerance. of the ODE solver.
    use_norm (bool): if True keeps the norm of func.
    norm (list of torch.tensor): the norm of the derivative.</p>

<pre><code>Method
forward (Callable)
    x (torch.tensor): the initial sample
    t (torch.tensor) time points where we suppose x is from t[0]
    return the last sample or the whole seq.</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ToySDEModel" class="doc_header"><code>class</code> <code>ToySDEModel</code><a href="https://github.com/KrishnaswamyLab/MIOFlow/tree/main/MIOFlow/models.py#L229" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ToySDEModel</code>(<strong><code>func</code></strong>, <strong><code>method</code></strong>=<em><code>'euler'</code></em>, <strong><code>noise_type</code></strong>=<em><code>'diagonal'</code></em>, <strong><code>sde_type</code></strong>=<em><code>'ito'</code></em>, <strong><code>in_features</code></strong>=<em><code>2</code></em>, <strong><code>out_features</code></strong>=<em><code>2</code></em>, <strong><code>gunc</code></strong>=<em><code>None</code></em>, <strong><code>dt</code></strong>=<em><code>0.1</code></em>) :: <code>Module</code></p>
</blockquote>
<p>Neural SDE model
    func (nn.Module): drift term.
    genc (nn.Module): diffusion term.
    method (str): method of the SDE solver.</p>

<pre><code>Method
forward (Callable)
    x (torch.tensor): the initial sample
    t (torch.tensor) time points where we suppose x is from t[0]
    return the last sample or the whole seq.</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

</div>


